<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>File Uploader references</title>

    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet" type="text/css">
    <style>
        body, html {
            width: 100%;
            height: 100%;
        }

        body {
            
        }

        .menu {
            width: 20%;
            height: 100%;
            background-color: #f7f8f9;
            padding: 15px;
            position: fixed;
        }

        .menu > h2 {
            padding: 0 0 20px 0;
            margin: 0;
            font-variant: all-small-caps;
            text-transform: lowercase;
            font-weight: bold;
            color: hsla(203,20%,40%,.7);
        }

        .menu-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .menu-list > li {
            margin-top: 2px;
        }

        .content {
            width: 70%;
            height: 100%;
            padding: 2% 5% 0 5%;
            margin-left: 20%;
        }

        .point {
            width: 13%;
            display: inline-block;
        }

        .s-content {
            width: 87%;
            display: block;
        }

        .menu-list > li > a {
            text-decoration: none;
            color: black;
            display: flex;
            flex-direction: row;
            border-bottom: 2px solid transparent;
        }

        .menu-list > li > a:hover {
            border-bottom: 2px solid #3980B5;
            background: rgba(0,0,0,0.1);
        }

        .content > h1, h2, h3, h4, h5 {
            font-family: sans-serif;
            font-weight: normal;
            color: #005A9C;
        }

        .content > h1 {
            font-weight: bold!important;
            font-size: 220%;
            margin: 0;
            padding: 0;
        }

        .content > h2 {
            margin: 0;
            padding: 0 0 30px 0;
        }

        .content > h3 {
            font-size: 150%;
        }

        .content > h4 {
            padding: 10px 0 0 0;
            font-size: 120%;
        }

        .content > h5 {
            font-size: 100%;
            padding: 0;
            margin: 10px 0 0 0;
        }

        .content > p {
            margin: 0;
            padding: 0;
        }

        .content > code {
            display: block;
            background-color: #f7f8f9;
            border: 1px dashed black;
            padding: 10px;
            color: red;
            word-wrap: break-word;
            white-space: pre-wrap;
            margin: 5px 0 5px 0;
            font-family: 'Source Code Pro', monospace;
        }

        .js {
            color: green!important;
        }

        #footer {
            width: 100%;
            bottom: 0;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="menu">
        <h2>Table of contents</h2>

        <ol class="menu-list">
            <li>
                <a href="#introduction">
                    <span class="point">1</span>
                    <span class="s-content">Introduction</span>
                </a>
            </li>
            <li>
                <a href="#licence">
                    <span class="point">1.1</span>
                    <span class="s-content">Licence</span>
                </a>
            </li>
            <li>
                <a href="#about">
                    <span class="point">1.2</span>
                    <span class="s-content">About</span>
                </a>
            </li>
            <li>
                <a href="#download">
                    <span class="point">2</span>
                    <span class="s-content">Download</span>
                </a>
            </li>
            <li>
                <a href="#installation">
                    <span class="point">2.1</span>
                    <span class="s-content">Installation</span>
                </a>
            </li>
            <li>
                <a href="#configuration">
                    <span class="point">3</span>
                    <span class="s-content">Configuration</span>
                </a>
            </li>
            <li>
                <a href="#serverLinks">
                    <span class="point">3.1</span>
                    <span class="s-content">Server links</span>
                </a>
            </li>
            <li>
                <a href="#manualUpload">
                    <span class="point">3.2</span>
                    <span class="s-content">Manual upload button</span>
                </a>
            </li>
            <li>
                <a href="#filesValidation">
                    <span class="point">3.3</span>
                    <span class="s-content">Files validation</span>
                </a>
            </li>
            <li>
                <a href="#clientTramslation">
                    <span class="point">3.4</span>
                    <span class="s-content">Client translation</span>
                </a>
            </li>
            <li>
                <a href="#multiLanguagePage">
                    <span class="point">3.5</span>
                    <span class="s-content">Multi language support</span>
                </a>
            </li>
            <li>
                <a href="#requestsHeaders">
                    <span class="point">3.6</span>
                    <span class="s-content">Requests headers</span>
                </a>
            </li>
            <li>
                <a href="#fuAlert">
                    <span class="point">3.7</span>
                    <span class="s-content">Own alert function</span>
                </a>
            </li>
            <li>
                <a href="#server">
                    <span class="point">4</span>
                    <span class="s-content">Server</span>
                </a>
            </li>
            <li>
                <a href="#serverResponses">
                    <span class="point">4.1</span>
                    <span class="s-content">Responses</span>
                </a>
            </li>
            <li>
                <a href="#fileStatuses">
                    <span class="point">4.2</span>
                    <span class="s-content">File statuses</span>
                </a>
            </li>
            <li>
                <a href="#serverExamples">
                    <span class="point">4.3</span>
                    <span class="s-content">Examples</span>
                </a>
            </li>
            <li>
                <a href="#serverExamplesUploading">
                    <span class="point">4.3.1</span>
                    <span class="s-content">Uploading</span>
                </a>
            </li>
            <li>
                <a href="#serverExamplesDeleting">
                    <span class="point">4.3.2</span>
                    <span class="s-content">Deleting</span>
                </a>
            </li>
            <li>
                <a href="#serverExamplesEdit">
                    <span class="point">4.3.3</span>
                    <span class="s-content">File name edit</span>
                </a>
            </li>
            <li>
                <a href="#clientRequestsKeys">
                    <span class="point">4.4</span>
                    <span class="s-content">Client requests keys</span>
                </a>
            </li>
            <li>
                <a href="#serverResponseKeys">
                    <span class="point">4.5</span>
                    <span class="s-content">Server response keys</span>
                </a>
            </li>
            <li>
                <a href="#validator">
                    <span class="point">5</span>
                    <span class="s-content">Validator</span>
                </a>
            </li>
            <li>
                <a href="#ownValidationMethods">
                    <span class="point">5.1</span>
                    <span class="s-content">Own validation methods</span>
                </a>
            </li>
            <li>
                <a href="#fileObject">
                    <span class="point">6</span>
                    <span class="s-content">File object</span>
                </a>
            </li>
            <li>
                <a href="#fileObjectVariables">
                    <span class="point">6.1</span>
                    <span class="s-content">Variables</span>
                </a>
            </li>
            <li>
                <a href="#fileObjectMethods">
                    <span class="point">6.2</span>
                    <span class="s-content">Methods</span>
                </a>
            </li>
        </ol>
    </div>
<div class="content">
<h1 id="introduction">Files Uploader</h1>
<h2>Documentation, 28 June 2019</h2>
<p><b>Coded by:</b> <a href="https://github.com/Trzebu">Simon Fox (Trzebu)</a></p>
<p><b>Documented by:</b> <a href="https://github.com/Trzebu">Simon Fox (Trzebu)</a></p>
<p><b>Version:</b> 1.0</p>
<h3 id="licence">Licence</h3>
<p>MIT License</p>
<p>Copyright (c) 2019 Trzebu</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<h3 id="about">About</h3>
Files uploader is a very light and fast HTML client to uploading files in your web site. You can configure what can be uploaded, how much files can be uploaded or you can set maximum files size. Simple code construction allows you to fast modernize and implementate this client in your web stie.
<h3 id="download">Download</h3>
You can download client source from <a href="https://github.com/Trzebu/Files-uploader">my github</a> or from <a href="https://github.com/Trzebu/Files-uploader/archive/master.zip">this link</a>.
<h3 id="installation">Installation</h3>
<h5>CSS</h5>
Copy-paste the stylesheet link into your head tag.
<code>&lt;link rel="stylesheet" href="/src/css/files-uploader.css"></code>
<h5>JS</h5>
Files uploader require the use of JavaScript to function. Copy-paste the scripts link into your head tag.
<code>&lt;script src="/src/js/files-uploader.js">&lt;/script></code>
<h5>HTML</h5>
Copy the HTML code below and paste the code in the most convenient place for you.
<code>&lt;div id="fu-container">
    &lt;div class="fu-buttons">
        &lt;div class="fu-upload-button-selector">
            &lt;label for="fuFiles">
               &lt;i class="ico images-folder-i">&lt;/i> Select Files
            &lt;/label>
            &lt;input title="Select Files" multiple type="file" name="fuFiles" id="fuFiles">
        &lt;/div>
        &lt;button id="fuManualUploadTrigger">
            &lt;i class="ico upload-i">&lt;/i> Upload
        &lt;/button>
    &lt;/div>
    &lt;div id="fu-upload-progressbar">
        &lt;div>
            &lt;div id="fu-upload-progress">&lt;/div>
            &lt;span>21MB / 37MB&lt;/span>
        &lt;/div>
    &lt;/div>
    &lt;ul id="fuFilesList">&lt;/ul>
&lt;/div>
</code>
<h3 id="configuration">Configuration</h3>
The following are all configuration constants:
<code class="js">var FU_CONFIG = {
    "MANUAL_UPLOAD_TRIGGER": false,
    "MAX_FILES": 0,
    "MAX_FILE_SIZE": 0,
    "MAX_FILES_SIZE": 0,
    "MIN_FILE_SIZE": 0,
    "ALLOWED_EXTENSIONS": [],
    "UNALLOWED_EXTENSIONS": [],
    "IMAGE_MAX_WIDTH": 0,
    "IMAGE_MIN_WIDTH": 0,
    "IMAGE_MAX_HEIGHT": 0,
    "IMAGE_MIN_HEIGHT": 0,
    "SERVER_API": {
        "UPLOAD": "",
        "DELETE": "",
        "EDIT": "",
        "PREVIEW": ""
    }
};
</code>
<h4 id="serverLinks">Server links</h4>
Below you can see how configuration constants must be settled so that the client works properly.
<h5>Uploading</h5>
<code class="js">FU_CONFIG["SERVER_API"]["UPLOAD"] = "link/to/your/upload/route";</code>
<h5>Deleting*</h5>
<code class="js">FU_CONFIG["SERVER_API"]["DELETE"] = "link/to/your/delete/route";</code>
<h5>Edit*</h5>
<code class="js">FU_CONFIG["SERVER_API"]["EDIT"] = "link/to/your/edit/route";</code>
<h5>Previewing*</h5>
<code class="js">FU_CONFIG["SERVER_API"]["PREVIEW"] = "link/to/your/uploaded/route";</code>
*these values are not required for basic client operation.
<h4 id="manualUpload">Manual upload</h4>
If you want to controll start of the uploading manual you can do it by settled configuration constant to true like this:
<code class="js">FU_CONFIG["MANUAL_UPLOAD_TRIGGER"] = true;</code>
<h4 id="filesValidation">Files validation</h4>
My files uploader have initial validation functionality. Initially all validation rules are disabled (when value is set to 0 or to empty string or to empty array it's means that rule is disabled).
<h5>Maximum files amount</h5>
Here you can define how many files you can send at once.
<code class="js">FU_CONFIG["MAX_FILES"] = 5; // Now files limit is 5</code>
<h5>Maximum single file size</h5>
If you want to limit single file size you can do it here:
<code class="js">FU_CONFIG["MAX_FILE_SIZE"] = 1024; // Now size limit is 1KB.
FU_CONFIG["MIN_FILE_SIZE"] = 500; // Even minimum file size limit is available to set.</code>
<h5>Maximum files size</h5>
If you want to set the total size limit of all files you can do it here:
<code class="js">FU_CONFIG["MAX_FILES_SIZE"] = 10240; // Now size limit is 10KB.</code>
<h5>Allowed extensions / unallowed extensions</h5>
Here you can define extensions allowed in files validation.
<code class="js">FU_CONFIG["ALLOWED_EXTENSIONS"] = ["jpg", "png", "bmp", "gif"]; // Only files with extensions on this list will be allowed to upload.
FU_CONFIG["UNALLOWED_EXTENSIONS"] = ["png"]; // Now all extensions are available but png will be rejected.
</code>
<h5>Images limits</h5>
Even you can limit images.
<code class="js">FU_CONFIG["IMAGE_MAX_WIDTH"] = 200; // Maximum images width is 200px.
FU_CONFIG["IMAGE_MIN_WIDTH"] = 50; // Minimum images width is 50px.
FU_CONFIG["IMAGE_MAX_HEIGHT"] = 300; // Maximum images height is 300px.
FU_CONFIG["IMAGE_MIN_HEIGHT"] = 50; // Minimum images height is 50px.
</code>
<h4 id="clientTramslation">Client translation</h4>
I use array with messages to all client errors, alerts, etc. So this give you very simple way to translate "files uploader" client to language what you use in your web site.
<h5>Example translation:</h5>
<code class="js">MESSAGES["CANCEL"] = "Cancel" // Default EN translation.
MESSAGES["CANCEL"] = "Anuluj"; // Translated to PL.
MESSAGES["CANCEL"] = "Stornieren"; // Translated to DE.
</code>
<h5 id="multiLanguagePage">Multi language page</h5>
<p>By default, this script supports translations for one language only, but you can easily change it.</p>
<p>Example to multi language pages:</p>
<code class="js">var TRANSLATIONS = { // First create object with all transaltions.
    "en": { // Default EN translations.
        "TYPE_ERROR": "This file has wrong extension. Correct extensions: {EXTENSIONS}.",
        "NO_FILES_ERROR": "No files to save."
    },
    "de": { // For a new language, create a new object with a key called the language shortcut.
        "TYPE_ERROR": "Diese Datei hat die falsche Erweiterung. Richtige Erweiterung ist: {EXTENSIONS}.",
        "NO_FILES_ERROR": "Keine zu speichernden Dateien."
    },
    "pl": { // For a new language, create a new object with a key called the language shortcut.
        "TYPE_ERROR": "Ten plik ma złe rozszerzenie. Poprawne rozszerzenia to: {EXTENSIONS}.",
        "NO_FILES_ERROR": "Brak plików do zapisu."
    }
}

var userLanguage = document.querySelector("html").getAttribute("lang"); // Even you can get this value from cookie or something like this.
userLanguage = Object.keys(TRANSLATIONS).includes(userLanguage) ? userLanguage : "en";

var MESSAGES = TRANSLATIONS[userLanguage]; // Done. Now script will be use appropriate translation to each user.
</code>
<h4 id="requestsHeaders">Own requests headers</h4>
If you have server side csrf validation or something like this you can create own header with value required in reqeust.
<code class="js">var FU_CONFIG = {
    ...
    "REQUEST_HEADER": {
        "X-CSRF-TOKEN": "csrf-private-token",
        "TEST-HEADER-NAME": "TEST_HEADER_VALUE"
    }
};
</code>
Now every request will be sended with these values.
<h4 id="fuAlert">Own alert function</h4>
Normally a script use ugly alert functionality from your web browser. When you have own script to alerting something in your web page you can use code below to change what function will display alerts. (Near 686 line)
<code class="js">function fuAlert (message) {
    myOwnAlertFunction(message);
}
</code>
<h3 id="server">Server</h3>
<h4 id="serverResponses">Responses</h4>
All responses sended by server should be in JSON format. All responses should have "status" value. without this, the client can not check the correctness of the response and status will be automaticly set at 6.
<p><font color="green">Good response:</font></p>
<code>{
    "status": 6
}
</code>
<p><font color="red">Bad response:</font></p>
<code>{
    "statusCode": 2137
}
</code>
<h4 id="fileStatuses">Explanation of file status</h4>
<table border="1">
    <thead>
        <tr>
            <th>File status</th>
            <th>Explanation</th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td>0</td>
            <td>The file is being prepared for upload.</td>
        </tr>
        <tr>
            <td>1</td>
            <td>File is ready to upload.</td>
        </tr>
        <tr>
            <td>2</td>
            <td>The file has not passed the validation. (Client side validation error)</td>
        </tr>
        <tr>
            <td>3</td>
            <td>File is uploading.</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Server error while upload. (For example when server responde with 500 status code)</td>
        </tr>
        <tr>
            <td>5</td>
            <td>Error in server side validation. (The file has not passed the validation in your server validation)</td>
        </tr>
        <tr>
            <td>6</td>
            <td>File uploaded correctly.</td>
        </tr>
        <tr>
            <td>7</td>
            <td>File removed correctly.</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Inside uploader error.</td>
        </tr>
        <tr>
            <td>9</td>
            <td>File edit correctly.</td>
        </tr>
        <tr>
            <td>10</td>
            <td>File is uploaded, but waiting to upload other files from current queue.</td>
        </tr>
    </tbody>
</table>
<h4 id="serverExamples">Examples</h4>
<p>Some simple server implementations in PHP for files uploader client.</p>
<p><b>IMPORTANT NOTE:</b></p>
<p>These are very simple examples, they can contain numerous security errors! They should be treated only as an overview.</p>
<h5 id="serverExamplesUploading">Uploading</h4>
<code>if (empty($_FILES["file"])) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "No file selected."
    ]));
    return;
}
$path = pathinfo($_FILES["file"]["name"]);
$ext = $path['extension'];
$newFileName = bin2hex(random_bytes(15));

move_uploaded_file($_FILES['file']['tmp_name'], __dir__ . "/uploaded/" . $newFileName . "." . $ext);

$preparedPDO = $pdo->prepare("INSERT INTO files (name, path) VALUES (:name, :path)");
$preparedPDO->execute([
    ":name" => $newFileName,
    ":path" => $newFileName . "." . $ext
]);

echo(json_encode([
    "status" => 6,
    "newId" => $pdo->lastInsertId(),
    "newName" => $newFileName . "." . $ext
]));
</code>
<p>First I check if "file" post data exists. As you can se when $_FILES not containt "file" data I responde with status 5 and i sending message with information what happens wrong.</p>
<p>Every time when you validate file and there is a problem you must send status with 5 code (Error in server side validation) and error message in "errorMsg" variable.</p>
<code>if (empty($_FILES["file"])) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "No file selected."
    ]));
    return;
}
</code>
<p>Example error response:</p>
<code>{
    "status": 5,
    "errorMsg": "You'r file is to large! Maximum file size is 1KB."
}
</code>
<p>Next I'm getting file name, file extension and I generate random bytes to create unique file name. (This is not good way)</p>
<code>$path = pathinfo($_FILES["file"]["name"]);
$ext = $path['extension'];
$newFileName = bin2hex(random_bytes(15));
</code>
Now I upload file with new name to "uploaded" directory.
<code>move_uploaded_file($_FILES['file']['tmp_name'], __dir__ . "/uploaded/" . $newFileName . "." . $ext);</code>
Here i save some information about file to Data Base because it will help me later.
<code>$preparedPDO = $pdo->prepare("INSERT INTO files (name, path) VALUES (:name, :path)");
$preparedPDO->execute([
    ":name" => $newFileName,
    ":path" => $newFileName . "." . $ext
]);
</code>
And finally we can send response with information that all it's OK.
<code>echo(json_encode([
    "status" => 6,
    "newId" => $pdo->lastInsertId(),
    "newName" => $newFileName . "." . $ext
]));
</code>
Of course if you not save information to DB and not change file name you can send response in simplest form:
<code>{
    "status": 6   
}</code>
<h5 id="serverExamplesDeleting">Deleting</h4>
<code>if (empty($_POST["fileId"])) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "File ID you are searching for dose not exists."
    ]));
    return;
}

$selectPDO = $pdo->prepare("SELECT id, path FROM files WHERE id = ?");
$selectPDO->bindValue(1, $_POST["fileId"]);
$selectPDO->execute();
$results = $selectPDO->fetchAll(PDO::FETCH_OBJ);

if (count($results) === 0) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "File ID you are searching for dose not exists."
    ]));
    return;
}

$deletePDO = $pdo->prepare("DELETE FROM files WHERE id = ?");
$deletePDO->bindValue(1, $results[0]->id);
$deletePDO->execute();

unlink(__dir__ . "/uploaded/" . $results[0]->path);

echo(json_encode([
    "status" => 7
]));
</code>
I think that i don't need to explain it. Just like when sending files, I check if the file's ID has been sent and if it exists in the database.
<p>When file is removed correctly you must send response with status code 7</p>
<code>echo(json_encode([
    "status" => 7
])); 
</code>
<h5 id="serverExamplesEdit">File name edit</h5>
<code>if (empty($_POST["newFileName"]) || empty($_POST["fileId"])) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "You must type new file name!"
    ]));
    return;
}

$selectPDO = $pdo->prepare("SELECT id, path FROM files WHERE id = ?");
$selectPDO->bindValue(1, $_POST["fileId"]);
$selectPDO->execute();
$results = $selectPDO->fetchAll(PDO::FETCH_OBJ);

if (count($results) === 0) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "File ID you are searching for dose not exists."
    ]));
    return;
}

$ext = pathinfo($results[0]->path)["extension"];
$newFileName = $_POST["newFileName"] . "." . $ext;
$uploadedPath = __dir__ . "/uploaded/";

rename($uploadedPath . $results[0]->path, $uploadedPath . $newFileName);

$editPDO = $pdo->prepare("UPDATE files SET name = ?, path = ? WHERE id = ?");
$editPDO->bindValue(1, $_POST["newFileName"]);
$editPDO->bindValue(2, $newFileName);
$editPDO->bindValue(3, $_POST["fileId"]);
$editPDO->execute();

echo(json_encode([
    "status" => 9,
    "newFileName" => $newFileName
]));
</code>
Some validation before i change file name:
<code>if (empty($_POST["newFileName"]) || empty($_POST["fileId"])) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "You must type new file name!"
    ]));
    return;
}

$selectPDO = $pdo->prepare("SELECT id, path FROM files WHERE id = ?");
$selectPDO->bindValue(1, $_POST["fileId"]);
$selectPDO->execute();
$results = $selectPDO->fetchAll(PDO::FETCH_OBJ);

if (count($results) === 0) {
    echo(json_encode([
        "status" => 5,
        "errorMsg" => "File ID you are searching for dose not exists."
    ]));
    return;
}
</code>
Next I'm getting new name and create new file path:
<code>$ext = pathinfo($results[0]->path)["extension"];
$newFileName = $_POST["newFileName"] . "." . $ext;
$uploadedPath = __dir__ . "/uploaded/";
</code>
Here I change file name:
<code>rename($uploadedPath . $results[0]->path, $uploadedPath . $newFileName);</code>
Save it to DB:
<code>$editPDO = $pdo->prepare("UPDATE files SET name = ?, path = ? WHERE id = ?");
$editPDO->bindValue(1, $_POST["newFileName"]);
$editPDO->bindValue(2, $newFileName);
$editPDO->bindValue(3, $_POST["fileId"]);
$editPDO->execute();
</code>
And finally send response with status code 9 and new file name:
<code>echo(json_encode([
    "status" => 9,
    "newFileName" => $newFileName
]));
</code>
<h4 id="clientRequestsKeys">Client requests keys explanation</h4>
Files uploader script use some values in requests to working.
<table border="1">
    <thead>
        <th>Key</th>
        <th>Data type</th>
        <th>Sended by</th>
        <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>file</td>
            <td>File input stream</td>
            <td>File uplading method</td>
            <td>It is a file selected for upload by the client</td>
        </tr>
        <tr>
            <td>newFileName</td>
            <td>String</td>
            <td>Edit name method</td>
            <td>It is a new name sended by user.</td>
        </tr>
        <tr>
            <td>fileId</td>
            <td>Number</td>
            <td>Edit name / delete method</td>
            <td>It is a new ID responded by the server.</td>
        </tr>
    </tbody>
</table>
<h4 id="serverResponseKeys">Server response keys explanation</h4>
<table border="1">
    <thead>
        <th>Key</th>
        <th>*</th>
        <th>Data type</th>
        <th>Sended after</th>
        <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>status</td>
            <td></td>
            <td>Number</td>
            <td>Everywhere</td>
            <td>It is operation status. See <a href="#fileStatuses">Explanation of file status</a></td>
        </tr>
        <tr>
            <td>errorMsg</td>
            <td>*</td>
            <td>String</td>
            <td>Everywhere</td>
            <td>Error message displayed in file status when something wrong happens in server validation.</td>
        </tr>
        <tr>
            <td>newId</td>
            <td>*</td>
            <td>Number</td>
            <td>Upload</td>
            <td>It is a new ID generated by the server. It will be used in file deleting and in rename.</td>
        </tr>
        <tr>
            <td>newName</td>
            <td>*</td>
            <td>String</td>
            <td>Upload</td>
            <td>It is a new name generated by the server.</td>
        </tr>
        <tr>
            <td>newFileName</td>
            <td>*</td>
            <td>String</td>
            <td>Edit</td>
            <td>It is a new name given by user.</td>
        </tr>
    </tbody>
</table>
*Optional keys. Other keys are required in every response.
<h3 id="validator">Validator</h3>
My script have own validation method used to validate files before they are send to server. As this is a preliminary validation of the data, it is absolutely necessary to make sure that the files are correct on the server side.
<h4 id="ownValidationMethods">Own validation methods</h4>
<p>Below I'm try to explain you how to create new validation method. In this example I create method to checking if file has the appropriate length of the name.</p>
<p>First what we must do is it create new constant in FU_CONFIG.</p>
<code class="js">var FU_CONFIG = {
    ..., // Other configurations
    "MAX_FILE_NAME_LENGTH": 5 // Your key name and key value. 
}</code>
Now you must add new error message to MESSAGES array.
<code class="js">MESSAGES = {
    ..., // Other messages
    "MAX_FILE_NAME_LENGTH_ERROR": "This file has too long a name! The maximum length is {MAX_FILE_NAME_LENGTH}."
}</code>
Next you must find fuValidator object. (Near 173 line) In this object you can see variable named this.validationMethods = {...}. In this variable we must add new key with your configuration name key and new validation method name. Like below:
<code class="js">this.validationMethods = {
    "MAX_FILE_SIZE": "maxFileSize",
    ...,
    "MAX_FILE_NAME_LENGTH": "maxFileNameLength" // This is new validator method name.
}</code>
And finally below this.validation method you can create your new validator.
<code class="js">this.validation = function () {}

this.maxFileNameLength = function () {
    if (this.file.name > FU_CONFIG["MAX_FILE_NAME_LENGTH"]) {
        this.errors.push(MESSAGES["MAX_FILE_NAME_LENGTH_ERROR"].replace(
            "{MAX_FILE_NAME_LENGTH}",
            FU_CONFIG["MAX_FILE_NAME_LENGTH"]
        ));
    }
}

... // Other validators
</code>
Now any new selected file can not have a name longer than 5 characters.
<h3 id="fileObject">File object</h3>
This is the main object of the entire program. He is responsible for describing each file and has all the functions needed for processing files.
<h4 id="fileObjectVariables">Variables</h4>
<table border="1">
    <thead>
        <th>Name</th>
        <th>Data type</th>
        <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>fileData</td>
            <td>File</td>
            <td><a href="https://developer.mozilla.org/en-US/docs/Web/API/File">developer.mozilla.org/en-US/docs/Web/API/File</a></td>
        </tr>
        <tr>
            <td>imgObj</td>
            <td>undefined / img</td>
            <td><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement">developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement</a> (Enabled only when file is detected as image)</td>
        </tr>
        <tr>
            <td>id</td>
            <td>number</td>
            <td>Unique ID given by FileUploader object to be recognized in files list.</td>
        </tr>
        <tr>
            <td>totalBytesSended</td>
            <td>number</td>
            <td>Using to checking upload progress. Its initialized when file is sending to server.</td>
        </tr>
        <tr>
            <td>request</td>
            <td>undefined / XMLHttpRequest</td>
            <td><a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest</a></td>
        </tr>
        <tr>
            <td>newFileId</td>
            <td>number</td>
            <td>New file ID given by server after request. It is used only to other request (edit/delete). Client still uses <b>id</b>.</td>
        </tr>
        <tr>
            <td>newFileName</td>
            <td>String</td>
            <td>New file name given by user after edit.</td>
        </tr>
        <tr>
            <td>status</td>
            <td>number</td>
            <td>File status. See <a href="#fileStatuses">file statuses.</a></td>
        </tr>
    </tbody>
</table>
<h4 id="fileObjectMethods">Methods</h4>
<table border="1">
    <thead>
        <th>Name</th>
        <th>Arguments</th>
        <th>Return</th>
        <th>Description</th>
    </thead>
    <tbody>
        <tr>
            <td>ajax</td>
            <td>method, url, data</td>
            <td>Promise</td>
            <td>This is method to send flex request.</td>
        </tr>
        <tr>
            <td>showFileInList</td>
            <td>-</td>
            <td>Void</td>
            <td>This prepare list element to display it in list.</td>
        </tr>
        <tr>
            <td>cancelUploadingActivate</td>
            <td>-</td>
            <td>Void</td>
            <td>Activate cancel uploading button.</td>
        </tr>
        <tr>
            <td>remove</td>
            <td>-</td>
            <td>Void</td>
            <td>Remove file from list and from files array.</td>
        </tr>
        <tr>
            <td>abortUploadingRequest</td>
            <td>-</td>
            <td>Void</td>
            <td>When a file is transferred, this method stops sending it.</td>
        </tr>
        <tr>
            <td>validate</td>
            <td>-</td>
            <td>Void</td>
            <td>Checking whether file is valid.</td>
        </tr>
        <tr>
            <td>changeToError</td>
            <td>info</td>
            <td>Void</td>
            <td>Chenging displayed file to error status and show given message.</td>
        </tr>
        <tr>
            <td>changeToSuccess</td>
            <td>-</td>
            <td>Void</td>
            <td>Chenging displayed file to success status.</td>
        </tr>
        <tr>
            <td>loadThumbnail</td>
            <td>-</td>
            <td>Promise</td>
            <td>Checking whether file is image and displays the appropriate thumbnail.</td>
        </tr>
        <tr>
            <td>isImage</td>
            <td>-</td>
            <td>boolean</td>
            <td>Checking whether file is image.</td>
        </tr>
        <tr>
            <td>upload</td>
            <td>-</td>
            <td>Void</td>
            <td>Upload file to the server.</td>
        </tr>
        <tr>
            <td>changeFileName</td>
            <td>newName</td>
            <td>Void</td>
            <td>Changing file name in file list.</td>
        </tr>
        <tr>
            <td>fileControlls</td>
            <td>-</td>
            <td>Void</td>
            <td>Changing whether delete and edit route is set and display controll buttons.</td>
        </tr>
        <tr>
            <td>editNameActivate</td>
            <td>-</td>
            <td>Void</td>
            <td>Activate edit button.</td>
        </tr>
        <tr>
            <td>editNameSave</td>
            <td>-</td>
            <td>Void</td>
            <td>Send new file name to server.</td>
        </tr>
        <tr>
            <td>editNameCancel</td>
            <td>-</td>
            <td>Void</td>
            <td>Cancel edit and show other controll buttons.</td>
        </tr>
        <tr>
            <td>delete</td>
            <td>-</td>
            <td>Void</td>
            <td>Send delete request and if it response with success remove file from list.</td>
        </tr>
        <tr>
            <td>getShortName</td>
            <td>fileName (optional)</td>
            <td>string</td>
            <td>Cute given name to LIMIT and return it without ext.</td>
        </tr>
        <tr>
            <td>getFullName</td>
            <td>fileName (optional)</td>
            <td>string</td>
            <td>Return full file name without ext.</td>
        </tr>
        <tr>
            <td>getExt</td>
            <td>-</td>
            <td>string</td>
            <td>Return file ext.</td>
        </tr>
        <tr>
            <td>selector</td>
            <td>query (optional)</td>
            <td>Element</td>
            <td>Return html element of file list.</td>
        </tr>
    </tbody>
</table>

<div id="footer">
    2019, <a href="https://github.com/Trzebu">Trzebu</a>
</div>
</div>
</body>

</html>
